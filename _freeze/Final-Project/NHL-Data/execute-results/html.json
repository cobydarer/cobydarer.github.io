{
  "hash": "65cfee03abb42289c2631832b9eced67",
  "result": {
    "markdown": "---\ntitle: \"Analyzing NHL Data from 2007-2008 to 2018-2019\"\nformat: \n  html:\n    theme: cosmo  # zephyr pulse, sketchy, default, cosmo, vapor etc\nauthor:\n  - name: Coby Darer\n    email: darerjf@appstate.edu\n    affiliation:\n      - name: Appalachian State University\n        city: Boone\n        state: NC  \n        url: https://www.appstate.edu/\nabstract: >\n  This project will explore 5 v 5 data on NHL teams and players from the 2007-2008 season to the 2018-2019 season.\n---\n\n## Loading the Necessary Packages\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(nhldata)\nlibrary(dplyr)\nlibrary(lubridate)\nlibrary(tidyr)\nlibrary(ggplot2)\n```\n:::\n\n## Introduction\n\nThis project will explore some of the 5v5 data on NHL teams from the 2007-2008 season to the 2018-2019 season. Specifically 5v5 scoring over these years. It will look at data on skaters, goalies and teams as a whole. The division alignment has changed within this time frame so the teams will be split up into their current divisions (This is for readability more than comparing separate divisions). \n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nWest_conf <- teams %>%\n  filter(team %in% c(\"ANA\", \"ARI\", \"CGY\", \"CHI\", \"COL\", \"DAL\", \"EDM\", \"LA\", \"MIN\", \"NSH\", \"SJ\", \"STL\", \"VAN\", \"ATL\", \"WPG\", \"VGK\"))\n\nEast_conf <- teams %>%\n  filter(team %in% c(\"BOS\", \"BUF\", \"CAR\", \"CBJ\", \"DET\", \"FLA\", \"MTL\", \"NJ\", \"NYI\", \"NYR\", \"OTT\", \"PHI\", \"PIT\", \"TB\", \"TOR\", \"WSH\"))\n\nAtlantic_div <- East_conf %>%\n  filter(team %in% c(\"BOS\", \"BUF\", \"DET\", \"FLA\", \"MTL\", \"OTT\", \"TB\", \"TOR\"))\n\nMetro_div <- East_conf %>%\n  filter(team %in% c(\"CAR\", \"CBJ\", \"NJ\", \"NYI\", \"NYR\", \"PHI\", \"PIT\", \"WSH\"))\n\nCentral_div <- West_conf %>%\n  filter(team %in% c(\"ARI\", \"CHI\", \"COL\", \"DAL\", \"MIN\", \"NSH\", \"STL\", \"ATL\", \"WPG\"))\n\nPacific_div <- West_conf %>%\n  filter(team %in% c(\"ANA\", \"CGY\", \"EDM\", \"LA\", \"SJ\", \"VAN\", \"VGK\"))\n```\n:::\n\n\n## Exploring some data `teams`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(teams)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 362\nColumns: 28\n$ team      <chr> \"ANA\", \"ANA\", \"ANA\", \"ANA\", \"ANA\", \"ANA\", \"ANA\", \"ANA\", \"ANA…\n$ season    <chr> \"2007-2008\", \"2008-2009\", \"2009-2010\", \"2010-2011\", \"2011-20…\n$ gp        <dbl> 81, 82, 82, 82, 82, 48, 82, 82, 82, 82, 82, 81, 81, 81, 82, …\n$ toi       <dbl> 3396.38, 3645.19, 3746.91, 3852.90, 3890.68, 2319.80, 3822.9…\n$ cf        <dbl> 2596, 3060, 3141, 3024, 3326, 1970, 3500, 3610, 3646, 3495, …\n$ ca        <dbl> 2523, 2945, 3493, 3794, 3526, 2140, 3528, 3474, 3310, 3542, …\n$ c_plumin  <dbl> 73, 115, -352, -770, -200, -170, -28, 136, 336, -47, -207, -…\n$ cf_pct    <dbl> 50.71, 50.96, 47.35, 44.35, 48.54, 47.93, 49.80, 50.96, 52.4…\n$ cf_60     <dbl> 45.86, 50.37, 50.30, 47.09, 51.29, 50.95, 54.93, 55.51, 56.3…\n$ ca_60     <dbl> 44.57, 48.47, 55.93, 59.08, 54.38, 55.35, 55.37, 53.42, 51.1…\n$ gf        <dbl> 107, 145, 146, 134, 138, 89, 187, 158, 128, 145, 158, 136, 1…\n$ ga        <dbl> 95, 130, 144, 154, 154, 72, 133, 149, 131, 128, 135, 152, 13…\n$ g_plumin  <dbl> 12, 15, 2, -20, -16, 17, 54, 9, -3, 17, 23, -16, -12, -32, 2…\n$ gf_pct    <dbl> 52.97, 52.73, 50.34, 46.53, 47.26, 55.28, 58.44, 51.47, 49.4…\n$ gf_60     <dbl> 1.89, 2.39, 2.34, 2.09, 2.13, 2.30, 2.93, 2.43, 1.98, 2.25, …\n$ ga_60     <dbl> 1.68, 2.14, 2.31, 2.40, 2.37, 1.86, 2.09, 2.29, 2.02, 1.98, …\n$ xgf       <dbl> 108.93, 134.91, 132.19, 123.01, 133.14, 81.87, 153.17, 149.0…\n$ xga       <dbl> 114.61, 129.11, 156.27, 156.05, 149.34, 81.65, 144.53, 136.8…\n$ xg_plumin <dbl> -5.68, 5.80, -24.08, -33.04, -16.20, 0.22, 8.64, 12.21, 16.5…\n$ xgf_pct   <dbl> 48.73, 51.10, 45.83, 44.08, 47.13, 50.07, 51.45, 52.13, 53.0…\n$ xgf_60    <dbl> 1.92, 2.22, 2.12, 1.92, 2.05, 2.12, 2.40, 2.29, 2.26, 2.37, …\n$ xga_60    <dbl> 2.02, 2.13, 2.50, 2.43, 2.30, 2.11, 2.27, 2.10, 2.00, 2.19, …\n$ pent      <dbl> 406, 407, 378, 336, 274, 162, 292, 263, 329, 304, 271, 242, …\n$ pend      <dbl> 372, 337, 351, 309, 260, 137, 293, 251, 272, 275, 223, 204, …\n$ p_plumin  <dbl> -34, -70, -27, -27, -14, -25, 1, -12, -57, -29, -48, -38, -5…\n$ sh_pct    <dbl> 7.30, 8.40, 8.23, 7.87, 7.99, 8.59, 9.83, 8.48, 6.69, 7.77, …\n$ sv_pct    <dbl> 93.62, 92.42, 92.75, 92.31, 91.66, 93.01, 92.62, 91.82, 92.3…\n$ pdo       <dbl> 100.93, 100.82, 100.98, 100.18, 99.65, 101.60, 102.45, 100.3…\n```\n:::\n:::\n\n\nThere are 28 variables in the teams data set:\n\nNote: Corsi stat in hockey is Shot attempts\n\n1.    `team`: Team name\n\n2.    `season`: Season\n\n3.    `gp`: Games Played\n    \n4.    `toi` : Time on the ice\n    \n5.    `cf`: Corsi for\n    \n6.    `ca`: Corsi against\n    \n7.    `c_plumin` : Corsi plus/minus (cf-ca)\n    \n8.    `cf_60`: Corsi for per 60 minutes on the ice\n    \n9.    `cf_pct`: Corsi for as a percentage of total corsi\n    \n10.    `ca_60`: Corsi against per 60 minutes on the ice\n    \n11.    `gf` : Goals scored for a player's team\n    \n12.    `ga`: Goals scored against player's team\n    \n13.    `g_plumin`: Goals for - goals against\n    \n14.    `gf_pct`: Percentage of all goals scored by team\n    \n15.    `gf_60`: Goals for per 60 minutes on the ice\n    \n16.    `ga_60`: Goals against per 60 minutes on the ice\n    \n17.    `xgf`: Expected goals for\n    \n18.    `xga`: Expected goals against\n    \n19.    `xg_plumin`: Expected goals for - expected goals against\n    \n20.    `xgf_pct`: Expected goals for as a percentage of total expected goals for\n    \n21.    `xgf_60`: Expected goals for per 60 minutes on the ice\n\n22.    `xga_60`: Expected goals against per 60 minutes on the ice\n\n23.    `pent`: Penalties taken\n\n24.    `pend`: Penalties drawn\n\n25.    `p_plumin`: Penalties taken - individual penalties drawn\n\n26.    `sh_pct`: Shooting percentage\n\n27.    `sv_pct`: Save percentage\n\n28.    `pdo`: Just Win Baby\n\n\nSince we are exploring 5v5, let's see how important it is by looking at each teams goals for.\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nCentral_div %>%\n  filter(season != \"2012-2013\") %>%\n  ggplot(aes(x = season, y = gf, color = team)) + \n    geom_point() +\n    geom_line(aes(group = team)) +\n    geom_smooth(aes(group = 1), se = FALSE) + \n    theme_bw() + \n    theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Goals For\")\n\nPacific_div %>%\n  filter(season != \"2012-2013\") %>%\n  ggplot(aes(x = season, y = gf, color = team)) + \n    geom_point() +\n    geom_line(aes(group = team)) +\n    geom_smooth(aes(group = 1), se = FALSE) + \n    theme_bw() + \n    theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Goals For\")\n\nAtlantic_div %>%\n  filter(season != \"2012-2013\") %>%\n  ggplot(aes(x = season, y = gf, color = team)) + \n    geom_point() +\n    geom_line(aes(group = team)) +\n    geom_smooth(aes(group = 1), se = FALSE) + \n    theme_bw() + \n    theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Goals For\")\n\nMetro_div %>%\n  filter(season != \"2012-2013\") %>%\n  ggplot(aes(x = season, y = gf, color = team)) + \n    geom_point() +\n    geom_line(aes(group = team)) +\n    geom_smooth(aes(group = 1), se = FALSE) + \n    theme_bw() + \n    theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Goals For\")\n```\n\n::: {.cell-output-display}\n![Number of 5v5 goals for each team each season](NHL-Data_files/figure-html/fig-1-1.png){#fig-1-1 width=672}\n:::\n\n::: {.cell-output-display}\n![Number of 5v5 goals for each team each season](NHL-Data_files/figure-html/fig-1-2.png){#fig-1-2 width=672}\n:::\n\n::: {.cell-output-display}\n![Number of 5v5 goals for each team each season](NHL-Data_files/figure-html/fig-1-3.png){#fig-1-3 width=672}\n:::\n\n::: {.cell-output-display}\n![Number of 5v5 goals for each team each season](NHL-Data_files/figure-html/fig-1-4.png){#fig-1-4 width=672}\n:::\n:::\n\n\nNow let's look at shot attempts over the years.\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nCentral_div %>%\n  filter(season != \"2012-2013\") %>%\n  ggplot(aes(x = season, y = cf/gp, color = team)) + \n    geom_point() +\n    geom_line(aes(group = team)) +\n    geom_smooth(aes(group = 1), se = FALSE) + \n    theme_bw() + \n    theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Shot Attempts per Game\")\n\nPacific_div %>%\n  filter(season != \"2012-2013\") %>%\n  ggplot(aes(x = season, y = cf/gp, color = team)) + \n    geom_point() +\n    geom_line(aes(group = team)) +\n    geom_smooth(aes(group = 1), se = FALSE) + \n    theme_bw() + \n    theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Shot Attempts per Game\")\n\nAtlantic_div %>%\n  filter(season != \"2012-2013\") %>%\n  ggplot(aes(x = season, y = cf/gp, color = team)) + \n    geom_point() +\n    geom_line(aes(group = team)) +\n    geom_smooth(aes(group = 1), se = FALSE) + \n    theme_bw() + \n    theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Shot Attempts per Game\")\n\nMetro_div %>%\n  filter(season != \"2012-2013\") %>%\n  ggplot(aes(x = season, y = cf/gp, color = team)) + \n    geom_point() +\n    geom_line(aes(group = team)) +\n    geom_smooth(aes(group = 1), se = FALSE) + \n    theme_bw() + \n    theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Shot Attempts per Game\")\n```\n\n::: {.cell-output-display}\n![Number of 5v5 shot attempts for each team each season](NHL-Data_files/figure-html/fig-5-1.png){#fig-5-1 width=672}\n:::\n\n::: {.cell-output-display}\n![Number of 5v5 shot attempts for each team each season](NHL-Data_files/figure-html/fig-5-2.png){#fig-5-2 width=672}\n:::\n\n::: {.cell-output-display}\n![Number of 5v5 shot attempts for each team each season](NHL-Data_files/figure-html/fig-5-3.png){#fig-5-3 width=672}\n:::\n\n::: {.cell-output-display}\n![Number of 5v5 shot attempts for each team each season](NHL-Data_files/figure-html/fig-5-4.png){#fig-5-4 width=672}\n:::\n:::\n\n\nSo it looks like there was some fluctuation, but on average teams are scoring slightly more on 5v5 now than they used to and they are attempting more shots per game.\n\n## Exploring some data on `skaters`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(skaters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 9,402\nColumns: 48\n$ player      <chr> \"SEBASTIAN AHO\", \"AARON DOWNEY\", \"AARON EKBLAD\", \"AARON EK…\n$ season      <chr> \"2017-2018\", \"2007-2008\", \"2014-2015\", \"2015-2016\", \"2016-…\n$ team        <chr> \"NYI\", \"DET\", \"FLA\", \"FLA\", \"FLA\", \"FLA\", \"FLA\", \"DAL\", \"W…\n$ team2       <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, \"EDM\", NA,…\n$ team3       <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ position    <chr> \"D\", \"R\", \"D\", \"D\", \"D\", \"D\", \"D\", \"C\", \"C\", \"C\", \"D\", \"D\"…\n$ position2   <chr> \"D\", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ position3   <chr> \"R\", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ gp          <dbl> 22, 56, 81, 78, 68, 82, 82, 19, 7, 10, 30, 38, 41, 56, 10,…\n$ toi         <dbl> 324.64, 253.35, 1400.56, 1319.22, 1132.67, 1440.06, 1498.7…\n$ g           <dbl> 0, 0, 6, 9, 4, 9, 7, 0, 0, 3, 0, 2, 2, 2, 0, 0, 1, 0, 1, 0…\n$ a           <dbl> 3, 2, 16, 13, 7, 11, 12, 2, 0, 0, 1, 4, 4, 12, 0, 0, 6, 0,…\n$ p           <dbl> 3, 2, 22, 22, 11, 20, 19, 2, 0, 3, 1, 6, 6, 14, 0, 0, 7, 0…\n$ p1          <dbl> 1, 2, 14, 15, 7, 11, 13, 0, 0, 3, 0, 3, 5, 7, 0, 0, 2, 0, …\n$ p_60        <dbl> 0.55, 0.47, 0.94, 1.00, 0.58, 0.83, 0.76, 0.84, 0.00, 2.46…\n$ p1_60       <dbl> 0.18, 0.47, 0.60, 0.68, 0.37, 0.46, 0.52, 0.00, 0.00, 2.46…\n$ gs          <dbl> 1.99, 0.92, 38.10, 28.15, 21.36, 19.78, 23.60, 1.64, 1.17,…\n$ gs_60       <dbl> 0.37, 0.22, 1.63, 1.28, 1.13, 0.82, 0.94, 0.69, 1.07, 2.83…\n$ cf          <dbl> 289, 193, 1299, 1059, 1084, 1392, 1402, 127, 72, 64, 287, …\n$ ca          <dbl> 325, 183, 1112, 1034, 1003, 1520, 1432, 121, 58, 63, 304, …\n$ c_plumin    <dbl> -36, 10, 187, 25, 81, -128, -30, 6, 14, 1, -17, 28, -83, -…\n$ cf_pct      <dbl> 47.07, 51.33, 53.88, 50.60, 51.94, 47.80, 49.47, 51.21, 55…\n$ rel_cf_pct  <dbl> 2.26, -7.30, 3.83, 2.92, 1.97, -2.16, 0.09, 3.14, 8.63, 0.…\n$ gf          <dbl> 15, 6, 59, 56, 30, 69, 80, 3, 0, 5, 15, 23, 18, 29, 4, 1, …\n$ ga          <dbl> 19, 6, 43, 43, 47, 67, 82, 6, 1, 4, 11, 10, 25, 37, 4, 0, …\n$ g_plumin    <dbl> -4, 0, 16, 13, -17, 2, -2, -3, -1, 1, 4, 13, -7, -8, 0, 1,…\n$ gf_pct      <dbl> 44.12, 50.00, 57.84, 56.57, 38.96, 50.74, 49.38, 33.33, 0.…\n$ rel_gf_pct  <dbl> -0.48, -12.50, 11.78, -3.07, -7.58, 1.50, 5.93, -11.98, -4…\n$ xgf         <dbl> 10.49, 7.16, 50.88, 42.44, 38.23, 57.36, 63.91, 5.83, 2.89…\n$ xga         <dbl> 15.73, 7.76, 42.32, 44.38, 42.23, 65.83, 69.28, 4.84, 2.15…\n$ xg_plumin   <dbl> -5.24, -0.60, 8.56, -1.94, -4.00, -8.47, -5.37, 0.99, 0.74…\n$ xgf_pct     <dbl> 40.01, 47.99, 54.59, 48.88, 47.51, 46.56, 47.98, 54.64, 57…\n$ rel_xgf_pct <dbl> -3.96, -10.26, 4.30, -0.22, -0.17, -3.54, -0.04, 7.76, 13.…\n$ ipent       <dbl> 2, 31, 10, 15, 21, 20, 12, 1, 0, 1, 13, 11, 11, 5, 4, 0, 8…\n$ ipend       <dbl> 4, 15, 10, 6, 13, 9, 9, 0, 0, 1, 4, 5, 5, 7, 1, 1, 4, 0, 2…\n$ ip_plumin   <dbl> 2, -16, 0, -9, -8, -11, -3, -1, 0, 0, -9, -6, -6, 2, -3, 1…\n$ icf         <dbl> 50, 22, 229, 208, 248, 271, 227, 25, 12, 17, 33, 53, 70, 9…\n$ icf_60      <dbl> 9.24, 5.21, 9.81, 9.46, 13.14, 11.29, 9.09, 10.55, 11.02, …\n$ ixgf        <dbl> 0.77, 0.94, 3.98, 5.41, 5.59, 6.83, 5.35, 0.84, 0.54, 1.17…\n$ ixgf_60     <dbl> 0.14, 0.22, 0.17, 0.25, 0.30, 0.28, 0.21, 0.35, 0.50, 0.96…\n$ ish_pct     <dbl> 0.00, 0.00, 5.26, 7.50, 2.74, 6.98, 5.56, 0.00, 0.00, 27.2…\n$ pdo         <dbl> 99.82, 99.80, 100.86, 101.59, 96.77, 100.94, 99.22, 97.67,…\n$ zsr         <dbl> 43.37, 81.97, 60.73, 55.80, 58.93, 41.48, 45.76, 48.05, 58…\n$ toi_pct     <dbl> 30.30, 10.37, 36.09, 35.98, 35.20, 36.61, 37.72, 16.25, 18…\n$ toi_pct_qot <dbl> 27.25, 26.06, 28.14, 28.15, 27.69, 29.52, 29.32, 26.44, 29…\n$ cf_pct_qot  <dbl> 47.37, 57.52, 49.53, 48.73, 50.29, 51.68, 49.32, 44.92, 50…\n$ toi_pct_qoc <dbl> 28.78, 27.06, 28.56, 28.77, 28.91, 29.52, 29.89, 28.06, 28…\n$ cf_pct_qoc  <dbl> 50.10, 48.87, 49.31, 49.94, 50.02, 50.12, 50.19, 50.72, 48…\n```\n:::\n:::\n\n\nThere are 48 variables in the skaters data set:\n\nNote: Corsi stat in hockey is Shot attempts\n\n1.    `player`: Player name\n\n2.    `season`: Season\n\n3.    `team`: First team player played for in a given season\n    \n4.    `team2` : Second team player played for in a given season\n    \n5.    `team3`: Third team player played for in a given season\n    \n6.    `position`: Player's first position\n    \n7.    `position2` : Player's second position\n    \n8.    `position3`: Player's third position\n    \n9.    `gp`: Games Played\n    \n10.    `toi`: Time on the ice\n    \n11.    `g` : Goals scored\n    \n12.    `a`: Assists\n    \n13.    `p`: Points\n    \n14.    `p1`: Primary points (goals + primary assists)\n    \n15.    `p_60`: Points per 60 minutes on the ice\n    \n16.    `p1_60`: Primary points per 60 minutes on the ice\n    \n17.    `gs`: Game score\n    \n18.    `gs_60`: Game score per 60 minutes on the ice\n    \n19.    `cf`: Corsi for (shot attempts by player's team while player is on the ice)\n    \n20.    `ca`: Corsi against (shot attempts by opposing team will player is on the ice)\n    \n21.    `c_plumin`: Corsi plus/minus (cf-ca)\n\n22.    `cf_pct`: Corsi percentage\n\n23.    `rel_cf_pct`: Relative corsi percentage\n\n24.    `gf`: Goals scored for a player's team\n\n25.    `ga`: Goals scored against player's team\n\n26.    `g_plumin`: Shooting Goals for - goals against\n\n27.    `gf_pct`: Save Percentage of all goals scored by player's team\n\n28.    `rel_gf_pct`: Relative goals for percentage\n\n29.    `xgf`: Expected goals for\n\n30.    `xga`: Expected goals against\n\n31.    `xg_plumin`: Expected goals for - expected goals against\n\n32.    `xgf_pct`: Expected goals for as a percentage of a team's total expected goals for\n\n33.    `rel_xgf_pct`: Relative expected goals for as a percentage of a team's total expected goals for\n\n34.    `ipent`: Individual penalties taken\n\n35.    `ipend`: Individual penalties drawn\n\n36.    `ip_plumin`: Individual penalties taken - individual penalties drawn\n\n37.    `icf`: Individual corsi for\n\n38.    `icf_60`: Individual corsi for per 60 minutes on the ice\n\n39.    `ixgf`: Individual expected goals for\n\n40.    `ixgf_60`: Individual expected goals for per 60 minutes on the ice\n\n41.    `ish_pct`: Individual shooting percentage\n\n42.    `pdo`: Just Win Baby\n\n43.    `zsr`: Zone start ratio\n\n44.    `toi_pct`: Percentage of team's total time on ice played by player\n\n45.    `toi_pct_qot`: Percentage of team's total time on ice played by player, weighted by quality of teammates\n\n46.    `cf_pct_qot`: Corsi for percentage weighted by quality of player's teammates\n\n47.    `toi_pct_qoc`: Percentage of team's total time on ice played by player, weighted by quality of opponents\n\n48.    `cf_pct_qoc`: Corsi for percentage weighted by quality of player's opponents\n\nIt would be nice to see if the individual player stats reflect this slight increase in production.\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nskaters %>%\n  filter(season != \"2012-2013\") %>%\n  filter(p >= 50) %>%\n  ggplot(aes(x = season)) +\n    geom_bar(color = \"black\", fill = \"lightblue\") +\n    theme_bw() + \n    theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Count\")\n```\n\n::: {.cell-output-display}\n![Number of players with 50 or more 5v5 points](NHL-Data_files/figure-html/fig-9-1.png){#fig-9 width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nskaters %>%\n  filter(season != \"2012-2013\") %>%\n  filter(ish_pct >= 20) %>%\n  ggplot(aes(x = season)) +\n  geom_bar(color = \"black\", fill = \"lightblue\") + \n  theme_bw() + \n  theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Count\")\n```\n\n::: {.cell-output-display}\n![Number of players with at least 20% shooting percentage](NHL-Data_files/figure-html/fig-10-1.png){#fig-10 width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nskaters %>%\n  filter(season != \"2012-2013\") %>%\n  filter(ish_pct >= 10) %>%\n  ggplot(aes(x = season)) +\n  geom_bar(color = \"black\", fill = \"lightblue\") + \n  theme_bw() + \n  theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Count\")\n```\n\n::: {.cell-output-display}\n![Number of players with at least 10% shooting percentage](NHL-Data_files/figure-html/fig-11-1.png){#fig-11 width=672}\n:::\n:::\n\n\nInteresting, the amount of players with at least 50 points seems to be trending up in the last couple of years but is not more than some of the years in the past. Also shooting percentage has stayed relatively consistent, but at 20% there were some spikes.\n\n## Exploring some data on `goalies`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(goalies)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 856\nColumns: 16\n$ player   <chr> \"AARON DELL\", \"AARON DELL\", \"AARON DELL\", \"ADIN HILL\", \"ADIN …\n$ season   <chr> \"2016-2017\", \"2017-2018\", \"2018-2019\", \"2017-2018\", \"2018-201…\n$ team     <chr> \"SJ\", \"SJ\", \"SJ\", \"ARI\", \"ARI\", \"NYR\", \"NYR\", \"ARI\", \"OTT\", \"…\n$ team2    <chr> NA, NA, NA, NA, NA, NA, NA, \"BOS\", NA, \"NYR\", NA, NA, NA, NA,…\n$ team3    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ gp       <dbl> 20, 29, 25, 4, 13, 10, 33, 32, 43, 24, 16, 14, 11, 24, 22, 13…\n$ toi      <dbl> 951.31, 1235.49, 1057.78, 205.05, 545.18, 430.98, 1486.20, 12…\n$ sa       <dbl> 449, 606, 473, 113, 255, 274, 822, 534, 823, 472, 278, 215, 1…\n$ ga       <dbl> 23, 49, 45, 12, 25, 19, 69, 41, 64, 46, 24, 20, 18, 31, 41, 2…\n$ sv_pct   <dbl> 94.88, 91.91, 90.49, 89.38, 90.20, 93.07, 91.61, 92.32, 92.22…\n$ xsv_pct  <dbl> 92.44, 91.74, 91.24, 90.27, 91.73, 91.86, 91.76, 92.30, 92.14…\n$ dsv_pct  <dbl> 2.43, 0.17, -0.75, -0.88, -1.54, 1.21, -0.15, 0.02, 0.08, -2.…\n$ ldsv_pct <dbl> 98.64, 97.60, 98.03, 91.67, 95.76, 99.24, 98.06, 97.22, 98.67…\n$ mdsv_pct <dbl> 96.03, 92.97, 89.02, 93.75, 94.94, 89.77, 91.17, 92.24, 90.23…\n$ hdsv_pct <dbl> 82.05, 77.52, 78.30, 81.82, 72.41, 83.64, 79.33, 80.23, 83.06…\n$ gsaa     <dbl> 10.93, 1.05, -3.57, -1.00, -3.92, 3.31, -1.23, 0.12, 0.65, -1…\n```\n:::\n:::\n\n\nThere are 16 variables in the teams data set:\n\n1.    `player`: Player name\n\n2.    `season`: Season\n\n3.    `team`: First team player played for in a given season\n    \n4.    `team2` : Second team player played for in a given season\n    \n5.    `team3`: Third team player played for in a given season\n    \n6.    `gp`: Games Played\n    \n7.    `toi` : Time on the ice\n    \n8.    `sa`: Shots against\n    \n9.    `ga`: Goals against\n    \n10.    `sv_pct`: Save percentage\n    \n11.    `xsv_pct` : Expected save percentage\n    \n12.    `dsv_pct`: Dangerous save percentage\n    \n13.    `ldsv_pct`: Low danger save percentage\n    \n14.    `mdsv_pc`: Medium danger save percentage\n    \n15.    `hdsv_pct`: High danger save percentage\n    \n16.    `gsaa`: Goals saved above average\n\nHow have the goalies been affected over the years?\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ngoalies %>%\n  filter(season != \"2012-2013\") %>%\n  filter(sv_pct >= 91.00) %>%\n  filter(gp >= 45) %>%\n  ggplot(aes(x = season)) + \n  geom_bar(color = \"black\", fill = \"pink\") + \n  theme_bw() + \n  theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Count\")\n```\n\n::: {.cell-output-display}\n![Number of goalies with at least 45 games played and a 91% save percentage](NHL-Data_files/figure-html/fig-12-1.png){#fig-12 width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ngoalies <- goalies %>%\n  mutate(avg_sa_gp = sa/gp)\n\nfiltered_goalies <- goalies %>%\n  filter(season != \"2012-2013\") %>%\n  filter(gp > 5) %>%\n  filter(avg_sa_gp >= 20)\n\nggplot(filtered_goalies, aes(x = season)) + \n  geom_bar(color = \"black\", fill = \"pink\") + \n  theme_bw() + \n  theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Count\")\n```\n\n::: {.cell-output-display}\n![Number of who goalies faced an average of at least 20 shots a game](NHL-Data_files/figure-html/fig-13-1.png){#fig-13 width=672}\n:::\n:::\n\n\n## Looking at penalties\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nCentral_div %>%\n  filter(season != \"2012-2013\") %>%\n  ggplot(aes(x = season, y = pent, color = team)) + \n    geom_point() +\n    geom_line(aes(group = team)) +\n    geom_smooth(aes(group = 1), se = FALSE) + \n    theme_bw() + \n    theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Penalties Taken\")\n\nPacific_div %>%\n  filter(season != \"2012-2013\") %>%\n  ggplot(aes(x = season, y = pent, color = team)) + \n    geom_point() +\n    geom_line(aes(group = team)) +\n    geom_smooth(aes(group = 1), se = FALSE) + \n    theme_bw() + \n    theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Penalties Taken\")\n\nAtlantic_div %>%\n  filter(season != \"2012-2013\") %>%\n  ggplot(aes(x = season, y = pent, color = team)) + \n    geom_point() +\n    geom_line(aes(group = team)) +\n    geom_smooth(aes(group = 1), se = FALSE) + \n    theme_bw() + \n    theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Penalties Taken\")\n\nMetro_div %>%\n  filter(season != \"2012-2013\") %>%\n  ggplot(aes(x = season, y = pent, color = team)) + \n    geom_point() +\n    geom_line(aes(group = team)) +\n    geom_smooth(aes(group = 1), se = FALSE) + \n    theme_bw() + \n    theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Penalties Taken\")\n```\n\n::: {.cell-output-display}\n![Number of penalties taken by each team](NHL-Data_files/figure-html/fig-14-1.png){#fig-14-1 width=672}\n:::\n\n::: {.cell-output-display}\n![Number of penalties taken by each team](NHL-Data_files/figure-html/fig-14-2.png){#fig-14-2 width=672}\n:::\n\n::: {.cell-output-display}\n![Number of penalties taken by each team](NHL-Data_files/figure-html/fig-14-3.png){#fig-14-3 width=672}\n:::\n\n::: {.cell-output-display}\n![Number of penalties taken by each team](NHL-Data_files/figure-html/fig-14-4.png){#fig-14-4 width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nCentral_div %>%\n  filter(season != \"2012-2013\") %>%\n  ggplot(aes(x = season, y = p_plumin, color = team)) + \n    geom_point() +\n    geom_line(aes(group = team)) +\n    geom_smooth(aes(group = 1), se = FALSE) + \n    theme_bw() + \n    theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Penalty +-\")\n\nPacific_div %>%\n  filter(season != \"2012-2013\") %>%\n  ggplot(aes(x = season, y = p_plumin, color = team)) + \n    geom_point() +\n    geom_line(aes(group = team)) +\n    geom_smooth(aes(group = 1), se = FALSE) + \n    theme_bw() + \n    theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Penalty +-\")\n\nAtlantic_div %>%\n  filter(season != \"2012-2013\") %>%\n  ggplot(aes(x = season, y = p_plumin, color = team)) + \n    geom_point() +\n    geom_line(aes(group = team)) +\n    geom_smooth(aes(group = 1), se = FALSE) + \n    theme_bw() + \n    theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Penalty +-\")\n\nMetro_div %>%\n  filter(season != \"2012-2013\") %>%\n  ggplot(aes(x = season, y = p_plumin, color = team)) + \n    geom_point() +\n    geom_line(aes(group = team)) +\n    geom_smooth(aes(group = 1), se = FALSE) + \n    theme_bw() + \n    theme(axis.text.x = element_text(angle = 90)) + \n    labs(x = \"Season\",\n         y = \"Penalty +-\")\n```\n\n::: {.cell-output-display}\n![Net penalties by each team](NHL-Data_files/figure-html/fig-18-1.png){#fig-18-1 width=672}\n:::\n\n::: {.cell-output-display}\n![Net penalties by each team](NHL-Data_files/figure-html/fig-18-2.png){#fig-18-2 width=672}\n:::\n\n::: {.cell-output-display}\n![Net penalties by each team](NHL-Data_files/figure-html/fig-18-3.png){#fig-18-3 width=672}\n:::\n\n::: {.cell-output-display}\n![Net penalties by each team](NHL-Data_files/figure-html/fig-18-4.png){#fig-18-4 width=672}\n:::\n:::\n",
    "supporting": [
      "NHL-Data_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}